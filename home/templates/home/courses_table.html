{% load humanize learnk12_tags wagtailimages_tags %}

{% if paging_data %}
    <div class="d-flex justify-content-between">
        <small class="text-muted">{% page_result_figures paging_data %}</small>
        {% feedback_page 'Suggest a course on '|add:page.subject as feedback_page_url %}
        {% if feedback_page_url %}
            <small><a href="{{ feedback_page_url }}">Suggest a course</a></small>
        {% endif %}
    </div>
{% endif %}
<div class="table-responsive">
    <table class="table table-hover border-bottom">
        <thead class="thead-light">
            <tr>
                <th class="d-none d-lg-table-cell"></th>
                <th>Course</th>
                <th class="d-none d-lg-table-cell text-nowrap">Difficulty</th>
                <th class="d-none d-lg-table-cell">Cost</th>
                <th class="d-none d-lg-table-cell">Duration</th>
                <th class="d-none d-lg-table-cell">Provider</th>
                <th class="d-none d-lg-table-cell text-right">Reviews</th>
                <th class="d-lg-none">Details</th>
            </tr>
        </thead>
        <tbody>
            {% for page in courses %}
                <tr style="transform: rotate(0);">
                    <td class="d-none d-lg-table-cell">
                        {% with page.course_images.all|first as first_image %}
                            {% if first_image %}
                                {% image first_image.image fill-180x120 class="rounded border shadow-sm" %}
                            {% else %}
                                <div class="img-rect bg-light text-center rounded border shadow-sm">
                                    <i class="material-icons font-size-48 text-secondary centered">menu_book</i>
                                </div>
                            {% endif %}
                        {% endwith %}
                    </td>
                    <td>
                        <a href="{{ page.url }}" class="stretched-link lead font-weight-bold darkslategray">
                            {{ page.title }}
                        </a>
                        {% if page.tags %}
                            <div>
                                {% for tag in page.tags.all|dictsort:"name" %}
                                    <span class="badge badge-pill badge-info">{{ tag }}</span>
                                {% endfor %}
                            </div>
                        {% endif %}
                        <p class="my-1">{{ page.snippet|truncatewords:20 }}</p>
                    </td>
                    {% with page.difficulty|course_difficulty as difficulty_content %}
                    <td class="d-none d-lg-table-cell">
                        <div>{{ difficulty_content.label }}</div>
                        <div class="text-nowrap mt-n2">
                            {% spaceless %}
                                {% for _ in difficulty_content.dashes_filled %}
                                    <i class="material-icons font-size-12 text-info">
                                        radio_button_checked
                                    </i>
                                {% endfor %}
                                {% for _ in difficulty_content.dashes_empty %}
                                    <i class="material-icons font-size-12 text-muted">
                                        radio_button_unchecked
                                    </i>
                                {% endfor %}
                            {% endspaceless %}
                        </div>
                    </td>
                    {% endwith %}
                    <td class="d-none d-lg-table-cell">
                        {% if page.cost == 0 %}
                            Free
                        {% else %}
                            ${{ page.cost | floatformat:"0" | intcomma }}
                        {% endif %}
                    </td>
                    <td class="d-none d-lg-table-cell">
                        {{ page.duration_hours }} hour{{ page.duration_hours | pluralize }}
                    </td>
                    <td class="d-none d-lg-table-cell">{{ page.provider }}</td>
                    <td class="d-none d-lg-table-cell">
                        {% include 'home/page_star_rating.html' %}
                    </td>
                    <td class="d-lg-none">
                        {% include 'home/page_star_rating.html' with inline=True %}
                        {% include 'home/page_summary.html' with hide_labels_xs=True %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
